{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["/*\n * Created with @iobroker/create-adapter v2.6.3\n */\n\n// The adapter-core module gives you access to the core ioBroker functions\n// you need to create an adapter\nimport * as utils from \"@iobroker/adapter-core\";\nimport type { AxiosInstance } from \"axios\";\nimport axios from \"axios\";\nimport bodyParser from \"body-parser\";\nimport express from \"express\";\nimport * as os from \"os\";\nimport type { IVolumioClient, VolumioState } from \"./lib/volumioClient\";\nimport { VolumioClientFactory } from \"./lib/volumioClientFactory\";\nimport type { ApiMode } from \"./lib/volumioClientFactory\";\n\n// Extend adapter config interface with new properties\n/* eslint-disable @typescript-eslint/no-namespace */\ndeclare global {\n  namespace ioBroker {\n    interface AdapterConfig {\n      host: string;\n      apiMode: ApiMode;\n      pollInterval: number;\n      reconnectAttempts: number;\n      reconnectDelay: number;\n      subscribeToStateChanges: boolean;\n      subscriptionPort: number;\n      volumeSteps: number;\n      checkConnection: boolean;\n      checkConnectionInterval: number;\n    }\n  }\n}\n/* eslint-enable @typescript-eslint/no-namespace */\n\nclass Volumio extends utils.Adapter {\n  private volumioClient: IVolumioClient | null = null;\n  private axiosInstance: AxiosInstance | null = null; // Only for push notification endpoints (deprecated)\n  private checkConnectionInterval: NodeJS.Timeout | null = null;\n  private httpServer;\n  private httpServerInstance: any;\n\n  public constructor(options: Partial<utils.AdapterOptions> = {}) {\n    super({\n      ...options,\n      name: \"volumio\",\n    });\n    this.on(\"ready\", this.onReady.bind(this));\n    this.on(\"stateChange\", this.onStateChange.bind(this));\n    // this.on(\"objectChange\", this.onObjectChange.bind(this));\n    // this.on(\"message\", this.onMessage.bind(this));\n    this.on(\"unload\", this.onUnload.bind(this));\n\n    this.httpServer = express();\n    this.httpServer.use(bodyParser.urlencoded({ extended: false }));\n    this.httpServer.use(bodyParser.json());\n  }\n\n  /**\n   * Get local IP address for push notifications\n   */\n  private getLocalIp(): string {\n    const interfaces = os.networkInterfaces();\n    for (const name of Object.keys(interfaces)) {\n      const iface = interfaces[name];\n      if (iface) {\n        for (const alias of iface) {\n          if (alias.family === \"IPv4\" && !alias.internal) {\n            return alias.address;\n          }\n        }\n      }\n    }\n    return \"127.0.0.1\"; // Fallback to localhost\n  }\n\n  /**\n   * Handle state changes from Volumio client\n   *\n   * @param state\n   */\n  private handleStateChange(state: VolumioState): void {\n    this.log.debug(`State change received: ${JSON.stringify(state)}`);\n    this.updatePlayerState(state);\n  }\n\n  /**\n   * Handle connection state changes from Volumio client\n   *\n   * @param connected\n   */\n  private async handleConnectionChange(connected: boolean): Promise<void> {\n    this.log.info(\n      `Connection to Volumio ${connected ? \"established\" : \"lost\"}`,\n    );\n    await this.setStateAsync(\"info.connection\", connected, true);\n  }\n\n  /**\n   * Connect to Volumio instance\n   */\n  private async connectToVolumio(): Promise<boolean> {\n    this.log.debug(\"Connecting to Volumio ...\");\n    try {\n      await this.volumioClient?.connect();\n      this.log.info(\"Successfully connected to Volumio\");\n      return true;\n    } catch (error) {\n      this.log.error(`Failed to connect to Volumio: ${error}`);\n      return false;\n    }\n  }\n\n  /**\n   * Is called when databases are connected and adapter received configuration.\n   */\n  private async onReady(): Promise<void> {\n    // Initialize your adapter here\n\n    // Setup Volumio client using factory\n    const apiMode: ApiMode = this.config.apiMode || \"websocket\";\n    const port = 3000; // Default Volumio port\n\n    this.log.info(\n      `Initializing Volumio client in ${apiMode.toUpperCase()} mode (host: ${this.config.host || \"volumio.local\"}:${port})`,\n    );\n\n    this.volumioClient = VolumioClientFactory.create({\n      apiMode: apiMode,\n      host: this.config.host || \"volumio.local\",\n      port: port,\n      pollInterval: (this.config.pollInterval || 2) * 1000, // Convert to ms\n      reconnectAttempts: this.config.reconnectAttempts || 5,\n      reconnectDelay: (this.config.reconnectDelay || 2) * 1000, // Convert to ms\n      logger: this.log, // Pass ioBroker logger to client\n    });\n\n    // Setup axios instance for push notification endpoints (deprecated, REST-only)\n    if (apiMode === \"rest\" && this.config.subscribeToStateChanges) {\n      this.axiosInstance = axios.create({\n        baseURL: `http://${this.config.host}/api/v1/`,\n        timeout: 5000,\n      });\n    }\n\n    // Register callbacks\n    this.volumioClient.onStateChange(this.handleStateChange.bind(this));\n    this.volumioClient.onConnectionChange(\n      this.handleConnectionChange.bind(this),\n    );\n\n    // Ensure connection state object exists and reset the connection indicator during startup\n    await this.setObjectNotExistsAsync(\"info.connection\", {\n      type: \"state\",\n      common: {\n        role: \"indicator.connected\",\n        name: \"Connection state to Volumio instance\",\n        type: \"boolean\",\n        read: true,\n        write: false,\n        def: false,\n      },\n      native: {},\n    });\n    await this.setStateAsync(\"info.connection\", false, true);\n\n    // Subscribe to all state changes in the 'volumio' namespace\n    this.subscribeStates(\"*\");\n\n    // Try to connect to Volumio\n    const connectionSuccess = await this.connectToVolumio();\n\n    // Setup connection check interval\n    if (this.config.checkConnection) {\n      let interval = this.config.checkConnectionInterval;\n      if (!interval || !isNumber(interval)) {\n        this.log.error(\n          `Invalid connection check interval setting. Will be set to 60s`,\n        );\n        interval = 60;\n      }\n      this.checkConnectionInterval = setInterval(\n        this.checkConnection,\n        interval * 1000,\n        this,\n      );\n    }\n\n    // get system infos\n    if (connectionSuccess) {\n      this.getSystemInfo();\n      // get inital player state\n      this.getPlayerState();\n    }\n\n    // setup subscription mode if enabled\n    if (\n      this.config.subscribeToStateChanges &&\n      this.config.subscriptionPort &&\n      connectionSuccess\n    ) {\n      this.log.debug(\n        `Starting server on ${this.config.subscriptionPort} for subscription mode ...`,\n      );\n      try {\n        this.httpServerInstance = this.httpServer\n          .listen(this.config.subscriptionPort)\n          .on(\"error\", (error: any) => {\n            if (error.code === \"EADDRINUSE\") {\n              this.log.error(\n                `Port ${this.config.subscriptionPort} is already in use. Please choose another one. Subscription mode will not be available.`,\n              );\n              this.config.subscribeToStateChanges = false;\n            } else {\n              this.log.error(\n                `Starting server on ${this.config.subscriptionPort} for subscription mode failed: ${error}`,\n              );\n            }\n          });\n        this.log.debug(\n          `Server is listening on ${this.getLocalIp()}:${this.config.subscriptionPort}`,\n        );\n        this.subscribeToVolumioNotifications();\n      } catch (error) {\n        this.log.error(\n          `Starting server on ${this.config.subscriptionPort} for subscription mode failed: ${error}. Subscription mode will not be available.`,\n        );\n        this.config.subscribeToStateChanges = false;\n      }\n    } else if (\n      this.config.subscribeToStateChanges &&\n      !this.config.subscriptionPort\n    ) {\n      this.log.error(\n        \"Subscription mode is activated, but port is not configured.\",\n      );\n    } else if (!this.config.subscribeToStateChanges && connectionSuccess) {\n      this.unsubscribeFromVolumioNotifications();\n    }\n\n    this.httpServer.post(\"/volumiostatus\", (req, res) => {\n      this.onVolumioStateChange(req.body);\n      res.sendStatus(200);\n    });\n\n    // The adapters config (in the instance object everything under the attribute \"native\") is accessible via\n    // this.config:\n    // this.log.info(\"config option1: \" + this.config.option1);\n    // this.log.info(\"config option2: \" + this.config.option2);\n\n    /*\n        For every state in the system there has to be also an object of type state\n        Here a simple template for a boolean variable named \"testVariable\"\n        Because every adapter instance uses its own unique namespace variable names can't collide with other adapters variables\n        */\n    // await this.setObjectNotExistsAsync(\"testVariable\", {\n    //     type: \"state\",\n    //     common: {\n    //         name: \"testVariable\",\n    //         type: \"boolean\",\n    //         role: \"indicator\",\n    //         read: true,\n    //         write: true,\n    //     },\n    //     native: {},\n    // });\n\n    // In order to get state updates, you need to subscribe to them. The following line adds a subscription for our variable we have created above.\n    // this.subscribeStates(\"testVariable\");\n    // You can also add a subscription for multiple states. The following line watches all states starting with \"lights.\"\n    // this.subscribeStates(\"lights.*\");\n    // Or, if you really must, you can also watch all states. Don't do this if you don't need to. Otherwise this will cause a lot of unnecessary load on the system:\n    // this.subscribeStates(\"*\");\n\n    /*\n            setState examples\n            you will notice that each setState will cause the stateChange event to fire (because of above subscribeStates cmd)\n        */\n    // the variable testVariable is set to true as command (ack=false)\n    // await this.setStateAsync(\"testVariable\", true);\n\n    // same thing, but the value is flagged \"ack\"\n    // ack should be always set to true if the value is received from or acknowledged from the target system\n    // await this.setStateAsync(\"testVariable\", { val: true, ack: true });\n\n    // same thing, but the state is deleted after 30s (getState will return null afterwards)\n    // await this.setStateAsync(\"testVariable\", { val: true, ack: true, expire: 30 });\n\n    // examples for the checkPassword/checkGroup functions\n    // let result = await this.checkPasswordAsync(\"admin\", \"iobroker\");\n    // this.log.info(\"check user admin pw iobroker: \" + result);\n\n    // result = await this.checkGroupAsync(\"admin\", \"admin\");\n    // this.log.info(\"check group user admin group admin: \" + result);\n  }\n\n  /**\n   * Is called when adapter shuts down - callback has to be called under any circumstances!\n   *\n   * @param callback\n   */\n  private async onUnload(callback: () => void): Promise<void> {\n    try {\n      // Disconnect Volumio client\n      if (this.volumioClient) {\n        await this.volumioClient.disconnect();\n        this.volumioClient = null;\n      }\n\n      // Unsubscribe from push notifications (deprecated, REST-only)\n      if (\n        this.config.subscribeToStateChanges &&\n        this.config.apiMode === \"rest\"\n      ) {\n        this.unsubscribeFromVolumioNotifications();\n      }\n\n      // Clear connection check interval\n      if (this.checkConnectionInterval) {\n        clearInterval(this.checkConnectionInterval);\n        this.checkConnectionInterval = null;\n      }\n\n      // Terminate express http server (used for push notifications in REST mode)\n      if (this.httpServerInstance) {\n        this.httpServerInstance.close();\n      }\n\n      callback();\n    } catch (_e) {\n      callback();\n    }\n  }\n\n  // If you need to react to object changes, uncomment the following block and the corresponding line in the constructor.\n  // You also need to subscribe to the objects with `this.subscribeObjects`, similar to `this.subscribeStates`.\n  // /**\n  //  * Is called if a subscribed object changes\n  //  */\n  // private onObjectChange(id: string, obj: ioBroker.Object | null | undefined): void {\n  //     if (obj) {\n  //         // The object was changed\n  //         this.log.info(`object ${id} changed: ${JSON.stringify(obj)}`);\n  //     } else {\n  //         // The object was deleted\n  //         this.log.info(`object ${id} deleted`);\n  //     }\n  // }\n\n  /**\n   * Is called if a subscribed state changes\n   *\n   * @param id\n   * @param state\n   */\n  private onStateChange(\n    id: string,\n    state: ioBroker.State | null | undefined,\n  ): void {\n    if (!state) {\n      this.log.info(`state ${id} deleted`);\n      return;\n    }\n\n    if (state.ack) {\n      this.log.silly(\n        `State change of ${id} to \"${state.val}\" was already acknowledged. No need for further actions`,\n      );\n      return;\n    }\n\n    this.log.debug(`state ${id} changed to ${state?.val}`);\n    const stateId = id.replace(new RegExp(`^volumio.\\\\d+\\\\.`), \"\");\n    switch (stateId) {\n      case \"getPlaybackInfo\":\n        this.getPlayerState();\n        break;\n      case \"player.mute\":\n        this.volumeMute();\n        break;\n      case \"player.unmute\":\n        this.volumeUnmute();\n        break;\n      case \"player.next\":\n        this.nextTrack();\n        break;\n      case \"player.prev\":\n        this.previousTrack();\n        break;\n      case \"player.pause\":\n        this.playbackPause();\n        break;\n      case \"player.play\":\n        this.playbackPlay();\n        break;\n      case \"player.playN\":\n        this.playbackPlay(state.val);\n        break;\n      case \"player.stop\":\n        this.playbackStop();\n        break;\n      case \"player.toggle\":\n        this.playbackToggle();\n        break;\n      case \"playbackInfo.volume\":\n      case \"player.volume\":\n        this.volumeSetTo(state.val);\n        break;\n      case \"player.volume.down\":\n        this.volumeDown();\n        break;\n      case \"player.volume.up\":\n        this.volumeUp();\n        break;\n      case \"queue.clearQueue\":\n        this.clearQueue();\n        break;\n      case \"queue.repeatTrack\":\n        // toggle repeat track state\n        this.getStateAsync(\n          \"playbackInfo.repeatSingle\",\n          (err: any, state: { val: any }) => {\n            if (state) {\n              this.setRepeatTrack(!state.val);\n            }\n          },\n        );\n        break;\n      case \"playbackInfo.random\":\n      case \"queue.random\":\n        this.setRandomPlayback(state.val);\n        break;\n      case \"queue.shuffleMode\":\n        if (!isNumber(state.val)) {\n          this.log.warn(\n            \"queue.shuffleMode state change. Invalid state value passed\",\n          );\n          break;\n        }\n        if (state.val === 0) {\n          this.setRandomPlayback(false);\n        } else if (state.val === 1) {\n          this.setRandomPlayback(true);\n        } else if (state.val === 2) {\n          this.log.warn(\"queue.shuffleMode 2 not implemented yet\");\n        } else {\n          this.log.warn(\"Invalid value to queue.shuffleMode passed\");\n        }\n        break;\n      case \"queue.repeatTrackState\":\n        this.setRepeatTrack(state.val);\n        break;\n    }\n  }\n\n  // If you need to accept messages in your adapter, uncomment the following block and the corresponding line in the constructor.\n  // /**\n  //  * Some message was sent to this instance over message box. Used by email, pushover, text2speech, ...\n  //  * Using this method requires \"common.messagebox\" property to be set to true in io-package.json\n  //  */\n  // private onMessage(obj: ioBroker.Message): void {\n  //     if (typeof obj === \"object\" && obj.message) {\n  //         if (obj.command === \"send\") {\n  //             // e.g. send email or pushover or whatever\n  //             this.log.info(\"send command\");\n\n  //             // Send response in callback if required\n  //             if (obj.callback) this.sendTo(obj.from, obj.command, \"Message received\", obj.callback);\n  //         }\n  //     }\n  // }\n\n  private onVolumioStateChange(msg: any): void {\n    this.log.debug(`State change message received: ${JSON.stringify(msg)}`);\n    if (!msg || !msg.item) {\n      this.log.warn(\n        `Unprocessable state change message received: ${JSON.stringify(msg)}`,\n      );\n      return;\n    }\n    if (msg.item === \"state\") {\n      this.updatePlayerState(msg.data);\n    } else if (msg.item === \"queue\") {\n      // not implemented yet\n    } else {\n      this.log.warn(`Unknown state change event: '${msg.data}'`);\n    }\n  }\n\n  private async subscribeToVolumioNotifications(): Promise<void> {\n    // check if already subscribed\n    this.log.debug(\"Checking subscrition urls ...\");\n    const urls = await this.getPushNotificationUrls();\n    if (!urls) {\n      return;\n    }\n    this.setStateAsync(\"info.connection\", true, true);\n    if (urls.includes(`${this.getLocalIp()}:${this.config.subscriptionPort}`)) {\n      this.log.debug(\"Already subscribed to volumio push notifications\");\n      return;\n    }\n    // enter local http server as notification url\n    const data = {\n      url: `http://${this.getLocalIp()}:${this.config.subscriptionPort}/volumiostatus`,\n    };\n    this.axiosInstance\n      ?.post(\"pushNotificationUrls\", data)\n      .then((response) => {\n        if (response.data?.success) {\n          this.log.debug(\n            \"Subscription to volumio push notifications successful\",\n          );\n        } else {\n          this.log.error(\n            `Subscription to volumio push notifications failed: ${JSON.stringify(response?.data)}`,\n          );\n        }\n      })\n      .catch((err) => {\n        this.log.error(\n          `Subscription to volumio push notifications failed: ${err.message}`,\n        );\n        this.setStateAsync(\"info.connection\", false, true);\n      });\n  }\n\n  private async getPushNotificationUrls(): Promise<string | null> {\n    return JSON.stringify(\n      await this.axiosInstance\n        ?.get(\"pushNotificationUrls\")\n        .then((response) => {\n          return response.data;\n        })\n        .catch((err) => {\n          this.setStateAsync(\"info.connection\", false, true);\n          this.log.error(\n            `Error receiving pushNotificationUrls: ${err.message}`,\n          );\n          return null;\n        }),\n    );\n  }\n\n  private async unsubscribeFromVolumioNotifications(): Promise<void> {\n    this.log.debug(\"Unsubscribing from volumio push notifications ...\");\n    // check if was subscribed\n    const urls = await this.getPushNotificationUrls();\n    if (!urls) {\n      return;\n    }\n    if (\n      !urls.includes(`${this.getLocalIp()}:${this.config.subscriptionPort}`)\n    ) {\n      this.log.debug(\"Subscription was not active. No need to unsubscribe\");\n      return;\n    }\n    // remove local http server from notification urls\n    const data = {\n      url: `http://${this.getLocalIp()}:${this.config.subscriptionPort}/volumiostatus`,\n    };\n    this.axiosInstance\n      ?.delete(\"pushNotificationUrls\", data)\n      .then((response) => {\n        if (response.data?.success) {\n          this.log.debug(\n            \"Unsubscription from volumio push notifications successful\",\n          );\n        } else {\n          this.log.error(\n            `Unsubscription from volumio push notifications failed: ${JSON.stringify(response?.data)}`,\n          );\n        }\n      })\n      .catch((err) => {\n        this.log.error(\n          `Unsubscription from volumio push notifications failed: ${err.message}`,\n        );\n        this.setStateAsync(\"info.connection\", false, true);\n      });\n  }\n\n  async pingVolumio(): Promise<boolean> {\n    this.log.debug(\"Pinging volumio ...\");\n    try {\n      const result = await this.volumioClient?.ping();\n      if (result) {\n        this.log.debug(\"Volumio ping success\");\n        this.setState(\"info.connection\", true, true);\n        return true;\n      }\n      this.setState(\"info.connection\", false, true);\n      return false;\n    } catch (error) {\n      this.log.error(\n        `Connection to Volumio host (${this.config.host}) failed: ${error}`,\n      );\n      this.setState(\"info.connection\", false, true);\n      return false;\n    }\n  }\n\n  private checkConnection(context: any): void {\n    context.log.debug(\"Checking connection to Volumio ...\");\n    if (context.config.subscribeToStateChanges) {\n      context.subscribeToVolumioNotifications();\n    } else {\n      context.pingVolumio();\n    }\n  }\n\n  private async getSystemInfo(): Promise<void> {\n    try {\n      const info = await this.volumioClient?.getSystemInfo();\n      this.log.debug(`getSystemInfo response: ${JSON.stringify(info)}`);\n      if (info) {\n        this.updateSystemInfo(info);\n      }\n    } catch (error) {\n      this.log.error(`Error getting system info: ${error}`);\n    }\n  }\n\n  private async getPlayerState(): Promise<void> {\n    try {\n      const state = await this.volumioClient?.getState();\n      this.log.debug(`getState response: ${JSON.stringify(state)}`);\n      if (state) {\n        this.updatePlayerState(state);\n      }\n    } catch (error) {\n      this.log.error(`Error getting player state: ${error}`);\n    }\n  }\n\n  private updatePlayerState(state: any): void {\n    if (state.status !== undefined) {\n      this.setStateAsync(\"playbackInfo.status\", state.status, true);\n    }\n    if (state.position !== undefined) {\n      this.setStateAsync(\"playbackInfo.position\", String(state.position), true);\n    }\n    if (state.title !== undefined && state.track !== undefined) {\n      if (state.title !== state.track) {\n        this.log.warn(\n          `Title and track attibutes are both set but differ. Title will be set to ${state.title}`,\n        );\n        this.setStateAsync(\"playbackInfo.title\", state.title, true);\n      }\n      this.setStateAsync(\"playbackInfo.title\", state.title, true);\n    } else if (state.title !== undefined) {\n      this.setStateAsync(\"playbackInfo.title\", state.title, true);\n    } else if (state.track !== undefined) {\n      this.setStateAsync(\"playbackInfo.title\", state.track, true);\n    }\n    if (state.artist !== undefined) {\n      this.setStateAsync(\"playbackInfo.artist\", state.artist, true);\n    }\n    if (state.album !== undefined) {\n      this.setStateAsync(\"playbackInfo.album\", state.album, true);\n    }\n    if (state.albumart !== undefined) {\n      this.setStateAsync(\"playbackInfo.albumart\", state.albumart, true);\n    }\n    if (state.uri !== undefined) {\n      this.setStateAsync(\"playbackInfo.uri\", state.uri, true);\n    }\n    if (state.trackType !== undefined) {\n      this.setStateAsync(\"playbackInfo.trackType\", state.trackType, true);\n    }\n    if (state.codec !== undefined) {\n      this.setStateAsync(\"playbackInfo.codec\", state.codec, true);\n    }\n    if (state.seek !== undefined) {\n      const seek = typeof state.seek === \"string\" ? parseInt(state.seek, 10) : state.seek;\n      this.setStateAsync(\"playbackInfo.seek\", seek, true);\n    }\n    if (state.duration !== undefined) {\n      const duration = typeof state.duration === \"string\" ? parseInt(state.duration, 10) : state.duration;\n      this.setStateAsync(\"playbackInfo.duration\", duration, true);\n    }\n    if (state.samplerate !== undefined) {\n      this.setStateAsync(\"playbackInfo.samplerate\", state.samplerate, true);\n    }\n    if (state.bitdepth !== undefined) {\n      this.setStateAsync(\"playbackInfo.bitdepth\", state.bitdepth, true);\n    }\n    if (state.channels !== undefined) {\n      const channels = typeof state.channels === \"string\" ? parseInt(state.channels, 10) : state.channels;\n      this.setStateAsync(\"playbackInfo.channels\", channels, true);\n    }\n    if (state.random !== undefined) {\n      this.setStateAsync(\"playbackInfo.random\", state.random, true);\n    }\n    if (state.repeat !== undefined) {\n      this.setStateAsync(\"playbackInfo.repeat\", state.repeat, true);\n    }\n    if (state.repeatSingle !== undefined) {\n      this.setStateAsync(\"playbackInfo.repeatSingle\", state.repeatSingle, true);\n    }\n    if (state.consume !== undefined) {\n      this.setStateAsync(\"playbackInfo.consume\", state.consume, true);\n    }\n    if (state.volume !== undefined) {\n      const volume = typeof state.volume === \"string\" ? parseInt(state.volume, 10) : state.volume;\n      this.setStateAsync(\"playbackInfo.volume\", volume, true);\n      this.setStateAsync(\"player.volume\", volume, true);\n    }\n    if (state.dbVolume !== undefined) {\n      const dbVolume = typeof state.dbVolume === \"string\" ? parseFloat(state.dbVolume) : state.dbVolume;\n      this.setStateAsync(\"playbackInfo.dbVolume\", dbVolume, true);\n    }\n    if (state.disableVolumeControl !== undefined) {\n      this.setStateAsync(\n        \"playbackInfo.disableVolumeControl\",\n        state.disableVolumeControl,\n        true,\n      );\n    }\n    if (state.mute !== undefined) {\n      this.setStateAsync(\"playbackInfo.mute\", state.mute, true);\n      this.setStateAsync(\"player.muted\", state.mute, true);\n    }\n    if (state.stream !== undefined) {\n      const stream = typeof state.stream === \"boolean\" ? String(state.stream) : (state.stream || \"\");\n      this.setStateAsync(\"playbackInfo.stream\", stream, true);\n    }\n    if (state.updatedb !== undefined) {\n      this.setStateAsync(\"playbackInfo.updatedb\", state.updatedb, true);\n    }\n    if (state.volatile !== undefined) {\n      this.setStateAsync(\"playbackInfo.volatile\", state.volatile, true);\n    }\n    if (state.service !== undefined) {\n      this.setStateAsync(\"playbackInfo.service\", state.service, true);\n    }\n  }\n\n  private updateSystemInfo(systemInfo: any): void {\n    if (systemInfo.id !== undefined) {\n      this.setStateAsync(\"info.id\", systemInfo.id, true);\n    }\n    if (systemInfo.host !== undefined) {\n      this.setStateAsync(\"info.host\", systemInfo.host, true);\n    }\n    if (systemInfo.name !== undefined) {\n      this.setStateAsync(\"info.name\", systemInfo.name, true);\n    }\n    if (systemInfo.type !== undefined) {\n      this.setStateAsync(\"info.type\", systemInfo.type, true);\n    }\n    if (systemInfo.serviceName !== undefined) {\n      this.setStateAsync(\"info.serviceName\", systemInfo.serviceName, true);\n    }\n    if (systemInfo.systemversion !== undefined) {\n      this.setStateAsync(\"info.systemversion\", systemInfo.systemversion, true);\n    }\n    if (systemInfo.builddate !== undefined) {\n      this.setStateAsync(\"info.builddate\", systemInfo.builddate, true);\n    }\n    if (systemInfo.variant !== undefined) {\n      this.setStateAsync(\"info.variant\", systemInfo.variant, true);\n    }\n    if (systemInfo.hardware !== undefined) {\n      this.setStateAsync(\"info.hardware\", systemInfo.hardware, true);\n    }\n    if (systemInfo.isPremiumDevice !== undefined) {\n      this.setStateAsync(\n        \"info.isPremiumDevice\",\n        systemInfo.isPremiumDevice,\n        true,\n      );\n    }\n    if (systemInfo.isVolumioProduct !== undefined) {\n      this.setStateAsync(\n        \"info.isVolumioProduct\",\n        systemInfo.isVolumioProduct,\n        true,\n      );\n    }\n  }\n\n  private async nextTrack(): Promise<void> {\n    try {\n      await this.volumioClient?.next();\n      this.log.debug(\"Next track\");\n    } catch (error) {\n      this.log.error(`Error playing next track: ${error}`);\n    }\n  }\n\n  private async previousTrack(): Promise<void> {\n    try {\n      await this.volumioClient?.previous();\n      this.log.debug(\"Previous track\");\n    } catch (error) {\n      this.log.error(`Error playing previous track: ${error}`);\n    }\n  }\n\n  private async volumeMute(): Promise<void> {\n    try {\n      await this.volumioClient?.mute();\n      this.log.debug(\"Volume muted\");\n      this.setStateAsync(\"playbackInfo.mute\", true, true);\n      this.setStateAsync(\"player.muted\", true, true);\n    } catch (error) {\n      this.log.error(`Error muting volume: ${error}`);\n    }\n  }\n\n  private async volumeUnmute(): Promise<void> {\n    try {\n      await this.volumioClient?.unmute();\n      this.log.debug(\"Volume unmuted\");\n      this.setStateAsync(\"playbackInfo.mute\", false, true);\n      this.setStateAsync(\"player.muted\", false, true);\n    } catch (error) {\n      this.log.error(`Error unmuting volume: ${error}`);\n    }\n  }\n\n  private async playbackPause(): Promise<void> {\n    try {\n      await this.volumioClient?.pause();\n      this.log.debug(\"Playback paused\");\n      this.setStateAsync(\"playbackInfo.status\", \"pause\", true);\n    } catch (error) {\n      this.log.error(`Error pausing playback: ${error}`);\n    }\n  }\n\n  private async playbackPlay(n?: any): Promise<void> {\n    if (n && !isNumber(n)) {\n      this.log.warn(\"player.playN state change. Invalid state value passed\");\n      return;\n    }\n    try {\n      await this.volumioClient?.play(n);\n      this.log.debug(\"Playback started\");\n      this.setStateAsync(\"playbackInfo.status\", \"play\", true);\n    } catch (error) {\n      this.log.error(`Error starting playback: ${error}`);\n    }\n  }\n\n  private async playbackStop(): Promise<void> {\n    try {\n      await this.volumioClient?.stop();\n      this.log.debug(\"Playback stopped\");\n      this.setStateAsync(\"playbackInfo.status\", \"stop\", true);\n    } catch (error) {\n      this.log.error(`Error stopping playback: ${error}`);\n    }\n  }\n\n  private async playbackToggle(): Promise<void> {\n    try {\n      await this.volumioClient?.toggle();\n      this.log.debug(\"Playback toggled\");\n      this.getState(\"playbackInfo.status\", (_err, state) => {\n        if (state?.val === \"play\") {\n          this.setStateAsync(\"playbackInfo.status\", \"pause\", true);\n        } else if (state?.val === \"pause\" || state?.val === \"stop\") {\n          this.setStateAsync(\"playbackInfo.status\", \"play\", true);\n        }\n      });\n    } catch (error) {\n      this.log.error(`Error toggling playback: ${error}`);\n    }\n  }\n\n  private async volumeSetTo(value: any): Promise<void> {\n    if (!isNumber(value)) {\n      this.log.warn(\"player.volume state change. Invalid state value passed\");\n      return;\n    }\n\n    // Convert to number if it's a string\n    const volumeValue = typeof value === \"string\" ? parseInt(value, 10) : value;\n\n    try {\n      await this.volumioClient?.setVolume(volumeValue);\n      this.log.debug(`Volume set to ${volumeValue}`);\n      this.setStateAsync(\"playbackInfo.volume\", volumeValue, true);\n      this.setStateAsync(\"player.volume\", volumeValue, true);\n    } catch (error) {\n      this.log.error(`Error setting volume: ${error}`);\n    }\n  }\n\n  private async volumeUp(): Promise<void> {\n    try {\n      await this.volumioClient?.volumePlus();\n      this.log.debug(\"Volume increased\");\n    } catch (error) {\n      this.log.error(`Error increasing volume: ${error}`);\n    }\n  }\n\n  private async volumeDown(): Promise<void> {\n    try {\n      await this.volumioClient?.volumeMinus();\n      this.log.debug(\"Volume decreased\");\n    } catch (error) {\n      this.log.error(`Error decreasing volume: ${error}`);\n    }\n  }\n\n  private async setRandomPlayback(random: any): Promise<void> {\n    if (typeof random !== \"boolean\") {\n      this.log.warn(\"player.random state change. Invalid state value passed\");\n      return;\n    }\n    try {\n      await this.volumioClient?.setRandom(random);\n      this.log.debug(`Random play set to ${random}`);\n      this.setStateAsync(\"playbackInfo.random\", random, true);\n      this.setStateAsync(\"queue.shuffleMode\", random ? 1 : 0, true);\n    } catch (error) {\n      this.log.error(`Error setting random play: ${error}`);\n    }\n  }\n\n  private async clearQueue(): Promise<void> {\n    try {\n      await this.volumioClient?.clearQueue();\n      this.log.debug(`Queue cleared`);\n    } catch (error) {\n      this.log.error(`Error clearing queue: ${error}`);\n    }\n  }\n\n  private async setRepeatTrack(repeat: any): Promise<void> {\n    if (typeof repeat !== \"boolean\") {\n      this.log.warn(\n        \"player.repeatTrackState state change. Invalid state value passed\",\n      );\n      return;\n    }\n    try {\n      await this.volumioClient?.setRepeatSingle(repeat);\n      this.log.debug(`Repeat track set to ${repeat}`);\n      this.setStateAsync(\"playbackInfo.repeatSingle\", repeat, true);\n      this.setStateAsync(\"queue.repeatSingle\", repeat ? 1 : 0, true);\n    } catch (error) {\n      this.log.error(`Error setting repeat track: ${error}`);\n    }\n  }\n}\n\nfunction isNumber(value: any): boolean {\n  return value != null && value !== \"\" && !isNaN(Number(value.toString()));\n}\n\nif (require.main !== module) {\n  // Export the constructor in compact mode\n  module.exports = (options: Partial<utils.AdapterOptions> | undefined) =>\n    new Volumio(options);\n} else {\n  // otherwise start the instance directly\n  (() => new Volumio())();\n}\n"],
  "mappings": "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",
  "names": ["express", "bodyParser", "axios", "state", "_a"]
}
