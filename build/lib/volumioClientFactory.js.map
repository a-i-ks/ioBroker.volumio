{
  "version": 3,
  "sources": ["../../src/lib/volumioClientFactory.ts"],
  "sourcesContent": ["/**\n * Factory for creating Volumio API clients\n *\n * Creates either REST or WebSocket clients based on configuration.\n */\n\nimport type { IVolumioClient } from \"./volumioClient\";\nimport { RestVolumioClient } from \"./restVolumioClient\";\nimport type { RestClientConfig } from \"./restVolumioClient\";\nimport { WebSocketVolumioClient } from \"./websocketVolumioClient\";\nimport type { WebSocketClientConfig } from \"./websocketVolumioClient\";\nimport type { Logger } from \"./logger\";\n\nexport type ApiMode = \"rest\" | \"websocket\";\n\nexport interface VolumioClientFactoryConfig {\n  apiMode: ApiMode;\n  host: string;\n  port: number;\n  pollInterval?: number; // For REST mode only\n  reconnectAttempts?: number; // For WebSocket mode only\n  reconnectDelay?: number; // For WebSocket mode only\n  socketPath?: string; // For WebSocket mode only - Socket.IO path\n  transports?: (\"websocket\" | \"polling\")[]; // For WebSocket mode only - Transport methods\n  timeout?: number; // For WebSocket mode only - Connection timeout\n  forceNew?: boolean; // For WebSocket mode only - Force new connection\n  validateConnection?: boolean; // For WebSocket mode only - Validate connection after connect\n  logger?: Logger; // Optional logger instance\n}\n\nexport class VolumioClientFactory {\n  /**\n   * Create a Volumio client based on the specified API mode\n   *\n   * @param config\n   */\n  static create(config: VolumioClientFactoryConfig): IVolumioClient {\n    if (config.apiMode === \"websocket\") {\n      return VolumioClientFactory.createWebSocketClient(config);\n    }\n    return VolumioClientFactory.createRestClient(config);\n  }\n\n  /**\n   * Create a REST API client\n   *\n   * @param config\n   */\n  private static createRestClient(\n    config: VolumioClientFactoryConfig,\n  ): IVolumioClient {\n    const restConfig: RestClientConfig = {\n      host: config.host,\n      port: config.port,\n      pollInterval: config.pollInterval || 2000,\n      logger: config.logger, // Pass logger\n    };\n    return new RestVolumioClient(restConfig);\n  }\n\n  /**\n   * Create a WebSocket client\n   *\n   * @param config\n   */\n  private static createWebSocketClient(\n    config: VolumioClientFactoryConfig,\n  ): IVolumioClient {\n    const wsConfig: WebSocketClientConfig = {\n      host: config.host,\n      port: config.port,\n      reconnectAttempts: config.reconnectAttempts || 5,\n      reconnectDelay: config.reconnectDelay || 2000,\n      socketPath: config.socketPath, // Pass Socket.IO path\n      transports: config.transports, // Pass transport methods\n      timeout: config.timeout, // Pass connection timeout\n      forceNew: config.forceNew, // Pass forceNew flag\n      validateConnection: config.validateConnection, // Pass validation flag\n      logger: config.logger, // Pass logger\n    };\n    return new WebSocketVolumioClient(wsConfig);\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,+BAAkC;AAElC,oCAAuC;AAqBhC,MAAM,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMhC,OAAO,OAAO,QAAoD;AAChE,QAAI,OAAO,YAAY,aAAa;AAClC,aAAO,qBAAqB,sBAAsB,MAAM;AAAA,IAC1D;AACA,WAAO,qBAAqB,iBAAiB,MAAM;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,OAAe,iBACb,QACgB;AAChB,UAAM,aAA+B;AAAA,MACnC,MAAM,OAAO;AAAA,MACb,MAAM,OAAO;AAAA,MACb,cAAc,OAAO,gBAAgB;AAAA,MACrC,QAAQ,OAAO;AAAA;AAAA,IACjB;AACA,WAAO,IAAI,2CAAkB,UAAU;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,OAAe,sBACb,QACgB;AAChB,UAAM,WAAkC;AAAA,MACtC,MAAM,OAAO;AAAA,MACb,MAAM,OAAO;AAAA,MACb,mBAAmB,OAAO,qBAAqB;AAAA,MAC/C,gBAAgB,OAAO,kBAAkB;AAAA,MACzC,YAAY,OAAO;AAAA;AAAA,MACnB,YAAY,OAAO;AAAA;AAAA,MACnB,SAAS,OAAO;AAAA;AAAA,MAChB,UAAU,OAAO;AAAA;AAAA,MACjB,oBAAoB,OAAO;AAAA;AAAA,MAC3B,QAAQ,OAAO;AAAA;AAAA,IACjB;AACA,WAAO,IAAI,qDAAuB,QAAQ;AAAA,EAC5C;AACF;",
  "names": []
}
