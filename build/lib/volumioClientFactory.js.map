{
  "version": 3,
  "sources": ["../../src/lib/volumioClientFactory.ts"],
  "sourcesContent": ["/**\n * Factory for creating Volumio API clients\n *\n * Creates either REST or WebSocket clients based on configuration.\n */\n\nimport type { IVolumioClient } from \"./volumioClient\";\nimport { RestVolumioClient } from \"./restVolumioClient\";\nimport type { RestClientConfig } from \"./restVolumioClient\";\nimport { WebSocketVolumioClient } from \"./websocketVolumioClient\";\nimport type { WebSocketClientConfig } from \"./websocketVolumioClient\";\nimport type { Logger } from \"./logger\";\n\nexport type ApiMode = \"rest\" | \"websocket\";\n\nexport interface VolumioClientFactoryConfig {\n\tapiMode: ApiMode;\n\thost: string;\n\tport: number;\n\tpollInterval?: number; // For REST mode only\n\treconnectAttempts?: number; // For WebSocket mode only\n\treconnectDelay?: number; // For WebSocket mode only\n\tsocketPath?: string; // For WebSocket mode only - Socket.IO path\n\ttransports?: (\"websocket\" | \"polling\")[]; // For WebSocket mode only - Transport methods\n\ttimeout?: number; // For WebSocket mode only - Connection timeout\n\tforceNew?: boolean; // For WebSocket mode only - Force new connection\n\tvalidateConnection?: boolean; // For WebSocket mode only - Validate connection after connect\n\tlogger?: Logger; // Optional logger instance\n}\n\nexport class VolumioClientFactory {\n  /**\n   * Create a Volumio client based on the specified API mode\n   *\n   * @param config\n   */\n  static create(config: VolumioClientFactoryConfig): IVolumioClient {\n    if (config.apiMode === \"websocket\") {\n      return VolumioClientFactory.createWebSocketClient(config);\n    }\n    return VolumioClientFactory.createRestClient(config);\n  }\n\n  /**\n   * Create a REST API client\n   *\n   * @param config\n   */\n\tprivate static createRestClient(config: VolumioClientFactoryConfig): IVolumioClient {\n\t\tconst restConfig: RestClientConfig = {\n\t\t\thost: config.host,\n\t\t\tport: config.port,\n\t\t\tpollInterval: config.pollInterval || 2000,\n\t\t\tlogger: config.logger, // Pass logger\n\t\t};\n\t\treturn new RestVolumioClient(restConfig);\n\t}\n\n  /**\n   * Create a WebSocket client\n   *\n   * @param config\n   */\n\tprivate static createWebSocketClient(config: VolumioClientFactoryConfig): IVolumioClient {\n\t\tconst wsConfig: WebSocketClientConfig = {\n\t\t\thost: config.host,\n\t\t\tport: config.port,\n\t\t\treconnectAttempts: config.reconnectAttempts || 5,\n\t\t\treconnectDelay: config.reconnectDelay || 2000,\n\t\t\tsocketPath: config.socketPath, // Pass Socket.IO path\n\t\t\ttransports: config.transports, // Pass transport methods\n\t\t\ttimeout: config.timeout, // Pass connection timeout\n\t\t\tforceNew: config.forceNew, // Pass forceNew flag\n\t\t\tvalidateConnection: config.validateConnection, // Pass validation flag\n\t\t\tlogger: config.logger, // Pass logger\n\t\t};\n\t\treturn new WebSocketVolumioClient(wsConfig);\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,+BAAkC;AAElC,oCAAuC;AAqBhC,MAAM,qBAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMhC,OAAO,OAAO,QAAoD;AAChE,QAAI,OAAO,YAAY,aAAa;AAClC,aAAO,qBAAqB,sBAAsB,MAAM;AAAA,IAC1D;AACA,WAAO,qBAAqB,iBAAiB,MAAM;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOD,OAAe,iBAAiB,QAAoD;AACnF,UAAM,aAA+B;AAAA,MACpC,MAAM,OAAO;AAAA,MACb,MAAM,OAAO;AAAA,MACb,cAAc,OAAO,gBAAgB;AAAA,MACrC,QAAQ,OAAO;AAAA;AAAA,IAChB;AACA,WAAO,IAAI,2CAAkB,UAAU;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,OAAe,sBAAsB,QAAoD;AACxF,UAAM,WAAkC;AAAA,MACvC,MAAM,OAAO;AAAA,MACb,MAAM,OAAO;AAAA,MACb,mBAAmB,OAAO,qBAAqB;AAAA,MAC/C,gBAAgB,OAAO,kBAAkB;AAAA,MACzC,YAAY,OAAO;AAAA;AAAA,MACnB,YAAY,OAAO;AAAA;AAAA,MACnB,SAAS,OAAO;AAAA;AAAA,MAChB,UAAU,OAAO;AAAA;AAAA,MACjB,oBAAoB,OAAO;AAAA;AAAA,MAC3B,QAAQ,OAAO;AAAA;AAAA,IAChB;AACA,WAAO,IAAI,qDAAuB,QAAQ;AAAA,EAC3C;AACD;",
  "names": []
}
